!function(e){var t={};function i(r){if(t[r])return t[r].exports;var h=t[r]={i:r,l:!1,exports:{}};return e[r].call(h.exports,h,h.exports,i),h.l=!0,h.exports}i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var h in e)i.d(r,h,function(t){return e[t]}.bind(null,h));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="./",i(i.s=0)}([function(e,t,i){"use strict";i.r(t);var r;function h(e){if(null!==e){for(var t=e.cols;null!==t;){for(var i=t.cell;null!==i;){var r=i;i=i.nextCell,r.nextCell=null}var h=t;t=t.nextCol,h.nextCol=null,h.cell=null}e.cols=null}}function n(e,t,i){if(null==e)return console.error("Error. col pointer was null.\n"),0;if(t<=0)return console.error("Error. height must be positive.\n"),0;var r=0;i.startIndex=0;for(var h=e.cell,n=0;null!=h;h=h.nextCell,n++)if(h.occupied)r=0,i.startIndex=n+1;else{if(r+h.height>t)return i.endIndex=n,i.overshoot=t-r,1;if(r+h.height===t)return i.endIndex=n,i.overshoot=0,1;r+=h.height}return 0}function s(e,t){if(null==e)return console.error("Error. Basepointer was null.\n"),null;for(var i=e,r=0;r<t;r++)if(null==(i=i.nextCell))return console.error("Error. Offset to large.\n"),null;return i}function l(e,t){var i={colR:{startIndex:0,endIndex:0,overshoot:0},cellR:{startIndex:0,endIndex:0,overshoot:0}};return 0===function(e,t,i){for(var r=e.cols,h=0;null!=r;r=r.nextCol,h++){var l={startIndex:0,endIndex:0,overshoot:0},o={startIndex:0,endIndex:0,overshoot:0},c=0,a=void 0;if(n(r,t.height,o))for(l.startIndex=h,l.endIndex=h,a=r;null!=a;a=a.nextCol){var g=s(a.cell,o.startIndex);if(null===g||void 0===g?void 0:g.occupied)break;if(c+a.width>t.width)return l.overshoot=t.width-c,i.colR=l,i.cellR=o,1;if(c+a.width===t.width)return l.overshoot=0,i.colR=l,i.cellR=o,1;c+=a.width,l.endIndex++}}return 0}(e,t,i)?0:0===function(e,t){for(var i=null,r=e.cols,h=0;null!=r;r=r.nextCol,h++){if(t.cellR.overshoot>0){if(null==(c=s(r.cell,t.cellR.endIndex)))continue;var n={height:c.height-t.cellR.overshoot,occupied:c.occupied,nextCell:c.nextCell};c.height=t.cellR.overshoot,c.nextCell=n}h===t.colR.endIndex&&(i=r)}if(t.colR.overshoot>0){if(null==i)return console.log("Error. Failed to find column to split.\n"),0;for(var l={width:i.width-t.colR.overshoot,nextCol:null,cell:{height:0,occupied:0,nextCell:null}},o=l.cell,c=i.cell;null!=c;c=c.nextCell){if(o.height=c.height,o.occupied=c.occupied,null==c.nextCell){o.nextCell=null;break}o.nextCell={height:0,occupied:0,nextCell:null},o=o.nextCell}l.nextCol=i.nextCol,i.width=t.colR.overshoot,i.nextCol=l}return 1}(e,i)?(console.error("Error in splitting.\n"),0):0===function(e,t,i){if(!t.__id||0===t.__id)return console.error("Error. Rectangle can't have id = "+t.__id+".\n"),0;for(var r=0,h=0,n=0,s=e.cols,l=0;null!=s&&!(l>i.colR.endIndex);s=s.nextCol,l++){if(l>=i.colR.startIndex)for(var o=s.cell,c=0;null!=o&&!(c>i.cellR.endIndex);o=o.nextCell,c++)c>=i.cellR.startIndex&&(o.occupied=t.__id,n||(t.x=r,t.y=h,n=1)),h+=o.height;r+=s.width}return 1}(e,t,i)?(console.error("Error in updating.\n"),0):1}function o(e,t,i){for(var r=function(e,t){return{enclosingWidth:e,enclosingHeight:t,cols:{width:e,nextCol:null,cell:{height:t,occupied:0,nextCell:null}}}}(t,i),n=e.length,s=0;s<n;s++)if(!l(r,e[s]))return h(r),r=null,0;return h(r),r=null,1}function c(e){for(var t=e.length,i=0,r=0;r<t;r++){if(-1===e[r].x)return console.error("Error. Can't compute placing_width if not all rectangles have been placed.\n"),-1;e[r].width+e[r].x>=i&&(i=e[r].width+e[r].x)}return i}function a(e){if(!Array.isArray(e)||0===e.length)return[];var t=e.map((function(e,t){var i=e.width,r=e.height;if(!i||!r)throw new Error("Rectangle width and height must be an integer");return{width:i,height:r,x:-1,y:-1,__id:t+1}}));return 0===function(e,t){var i,h=function(e){for(var t=e.length,i=0,r=0,h=0;h<t;h++)e[h].width>=i&&(i=e[h].width),e[h].height>=r&&(r=e[h].height);return{width:i,height:r}}(e),n=h.width,s=h.height,l=function(e){for(var t=e.length,i=0,r=0,h=0;h<t;h++)i+=e[h].width,r+=e[h].height;return{width:i,height:r}}(e).width,a=-1,g=-1,d=-1,f=function(e){for(var t=e.length,i=0,r=0;r<t;r++)i+=e[r].height*e[r].width;return i}(e);t.height=s,t.width=l,d=t.height*t.width,i=r.DO_PLACING;for(var u=1;u;)switch(i){case r.DO_PLACING:1===o(e,t.width,t.height)?(t.width=c(e),d=t.height*t.width,a=t.width,g=t.height,i=r.DEC_WIDTH):i=r.INC_HEIGHT;break;case r.DEC_WIDTH:t.width--,i=t.width<n?r.STOP:r.DO_PLACING;break;case r.INC_HEIGHT:t.height++,i=t.height*t.width<f?r.INC_HEIGHT:t.height*t.width>=d?r.DEC_WIDTH:r.DO_PLACING;break;case r.STOP:u=0}return-1===a||-1===g?0:(o(e,a,g),1)}(t,{width:0,height:0})?(console.error("Unexpected error in algorithm implementation"),[]):(t.forEach((function(e){return delete e.__id})),t)}!function(e){e[e.DO_PLACING=0]="DO_PLACING",e[e.DEC_WIDTH=1]="DEC_WIDTH",e[e.INC_HEIGHT=2]="INC_HEIGHT",e[e.STOP=3]="STOP"}(r||(r={}));var g,d,f=function(){function e(e,t,i,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=e,this.y=t,this.width=i,this.height=r}return e.IsContainedIn=function(e,t){return e.x>=t.x&&e.y>=t.y&&e.x+e.width<=t.x+t.width&&e.y+e.height<=t.y+t.height},e}();!function(e){e[e.RectBestAreaFit=0]="RectBestAreaFit",e[e.RectBestShortSideFit=1]="RectBestShortSideFit",e[e.RectBestLongSideFit=2]="RectBestLongSideFit",e[e.RectWorstAreaFit=3]="RectWorstAreaFit",e[e.RectWorstShortSideFit=4]="RectWorstShortSideFit",e[e.RectWorstLongSideFit=5]="RectWorstLongSideFit"}(g||(g={})),function(e){e[e.SplitShorterLeftoverAxis=0]="SplitShorterLeftoverAxis",e[e.SplitLongerLeftoverAxis=1]="SplitLongerLeftoverAxis",e[e.SplitMinimizeArea=2]="SplitMinimizeArea",e[e.SplitMaximizeArea=3]="SplitMaximizeArea",e[e.SplitShorterAxis=4]="SplitShorterAxis",e[e.SplitLongerAxis=5]="SplitLongerAxis"}(d||(d={}));!function(){function e(e,t,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=!1),this.binWidth=e,this.binHeight=t,this.allowFlip=i,this.usedRectangles=[],this.freeRectangles=[],this.binWidth&&this.binHeight&&this.freeRectangles.push(new f(0,0,this.binWidth,this.binHeight))}e.prototype.InsertSizes=function(e,t,i,r){for(var h,n=0,s=0,l=!1;e.length>0;){for(var o=Number.MAX_VALUE,c=0;c<this.freeRectangles.length;++c)for(var a=0;a<e.length;++a){if(e[a].width===this.freeRectangles[c].width&&e[a].height===this.freeRectangles[c].height){n=c,s=a,l=!1,o=Number.MIN_VALUE,c=this.freeRectangles.length;break}if(this.allowFlip&&e[a].height===this.freeRectangles[c].width&&e[a].width===this.freeRectangles[c].height){n=c,s=a,l=!0,o=Number.MIN_VALUE,c=this.freeRectangles.length;break}if(e[a].width<=this.freeRectangles[c].width&&e[a].height<=this.freeRectangles[c].height)(g=this.ScoreByHeuristic(e[a].width,e[a].height,this.freeRectangles[c],i))<o&&(n=c,s=a,l=!1,o=g);else if(this.allowFlip&&e[a].height<=this.freeRectangles[c].width&&e[a].width<=this.freeRectangles[c].height){var g;(g=this.ScoreByHeuristic(e[a].height,e[a].width,this.freeRectangles[c],i))<o&&(n=c,s=a,l=!0,o=g)}}if(o===Number.MAX_VALUE)return;var d=e.splice(s,1)[0];d.x=this.freeRectangles[n].x,d.y=this.freeRectangles[n].y;var u=new f(this.freeRectangles[n].x,this.freeRectangles[n].y,d.width,d.height);l&&(h=[u.height,u.width],u.width=h[0],u.height=h[1]),this.SplitFreeRectByHeuristic(this.freeRectangles[n],u,r),this.freeRectangles.splice(n,1),t&&this.MergeFreeList(),this.usedRectangles.push(d)}},e.prototype.Fits=function(e,t){return e.width<=t.width&&e.height<=t.height||e.height<=t.width&&e.width<=t.height},e.prototype.FitsPerfectly=function(e,t){return e.width===t.width&&e.height===t.height||e.height===t.width&&e.width===t.height},e.prototype.Occupancy=function(){for(var e=0,t=0;t<this.usedRectangles.length;++t)e+=this.usedRectangles[t].width*this.usedRectangles[t].height;return e/(this.binWidth*this.binHeight)},e.prototype.ScoreByHeuristic=function(e,t,i,r){switch(r){case g.RectBestAreaFit:return this.ScoreBestAreaFit(e,t,i);case g.RectBestShortSideFit:return this.ScoreBestShortSideFit(e,t,i);case g.RectBestLongSideFit:return this.ScoreBestLongSideFit(e,t,i);case g.RectWorstAreaFit:return this.ScoreWorstAreaFit(e,t,i);case g.RectWorstShortSideFit:return this.ScoreWorstShortSideFit(e,t,i);case g.RectWorstLongSideFit:return this.ScoreWorstLongSideFit(e,t,i);default:return Number.MAX_VALUE}},e.prototype.ScoreBestAreaFit=function(e,t,i){return i.width*i.height-e*t},e.prototype.ScoreBestShortSideFit=function(e,t,i){var r=Math.abs(i.width-e),h=Math.abs(i.height-t);return Math.min(r,h)},e.prototype.ScoreBestLongSideFit=function(e,t,i){var r=Math.abs(i.width-e),h=Math.abs(i.height-t);return Math.max(r,h)},e.prototype.ScoreWorstAreaFit=function(e,t,i){return-this.ScoreBestAreaFit(e,t,i)},e.prototype.ScoreWorstShortSideFit=function(e,t,i){return-this.ScoreBestShortSideFit(e,t,i)},e.prototype.ScoreWorstLongSideFit=function(e,t,i){return-this.ScoreBestLongSideFit(e,t,i)},e.prototype.FindPositionForNewNode=function(e,t,i,r){for(var h=new f,n=Number.MAX_VALUE,s=0;s<this.freeRectangles.length;++s){if(e===this.freeRectangles[s].width&&t===this.freeRectangles[s].height){h.x=this.freeRectangles[s].x,h.y=this.freeRectangles[s].y,h.width=e,h.height=t,n=Number.MIN_VALUE,r.value=s;break}if(t===this.freeRectangles[s].width&&e===this.freeRectangles[s].height){h.x=this.freeRectangles[s].x,h.y=this.freeRectangles[s].y,h.width=t,h.height=e,n=Number.MIN_VALUE,r.value=s;break}if(e<=this.freeRectangles[s].width&&t<=this.freeRectangles[s].height)(l=this.ScoreByHeuristic(e,t,this.freeRectangles[s],i))<n&&(h.x=this.freeRectangles[s].x,h.y=this.freeRectangles[s].y,h.width=e,h.height=t,n=l,r.value=s);else if(t<=this.freeRectangles[s].width&&e<=this.freeRectangles[s].height){var l;(l=this.ScoreByHeuristic(t,e,this.freeRectangles[s],i))<n&&(h.x=this.freeRectangles[s].x,h.y=this.freeRectangles[s].y,h.width=t,h.height=e,n=l,r.value=s)}}return h},e.prototype.SplitFreeRectByHeuristic=function(e,t,i){var r,h=e.width-t.width,n=e.height-t.height;switch(i){case d.SplitShorterLeftoverAxis:r=h<=n;break;case d.SplitLongerLeftoverAxis:r=h>n;break;case d.SplitMinimizeArea:r=t.width*n>h*t.height;break;case d.SplitMaximizeArea:r=t.width*n<=h*t.height;break;case d.SplitShorterAxis:r=e.width<=e.height;break;case d.SplitLongerAxis:r=e.width>e.height;break;default:r=!0}this.SplitFreeRectAlongAxis(e,t,r)},e.prototype.SplitFreeRectAlongAxis=function(e,t,i){var r=new f(e.x,e.y+t.height,0,e.height-t.height),h=new f(e.x+t.width,e.y,e.width-t.width,0);i?(r.width=e.width,h.height=t.height):(r.width=t.width,h.height=e.height),r.width>0&&r.height>0&&this.freeRectangles.push(r),h.width>0&&h.height>0&&this.freeRectangles.push(h)},e.prototype.MergeFreeList=function(){for(var e=0;e<this.freeRectangles.length;++e)for(var t=e+1;t<this.freeRectangles.length;++t)this.freeRectangles[e].width===this.freeRectangles[t].width&&this.freeRectangles[e].x===this.freeRectangles[t].x?this.freeRectangles[e].y===this.freeRectangles[t].y+this.freeRectangles[t].height?(this.freeRectangles[e].y-=this.freeRectangles[t].height,this.freeRectangles[e].height+=this.freeRectangles[t].height,this.freeRectangles.splice(t,1),--t):this.freeRectangles[e].y+this.freeRectangles[e].height===this.freeRectangles[t].y&&(this.freeRectangles[e].height+=this.freeRectangles[t].height,this.freeRectangles.splice(t,1),--t):this.freeRectangles[e].height===this.freeRectangles[t].height&&this.freeRectangles[e].y===this.freeRectangles[t].y&&(this.freeRectangles[e].x===this.freeRectangles[t].x+this.freeRectangles[t].width?(this.freeRectangles[e].x-=this.freeRectangles[t].width,this.freeRectangles[e].width+=this.freeRectangles[t].width,this.freeRectangles.splice(t,1),--t):this.freeRectangles[e].x+this.freeRectangles[e].width===this.freeRectangles[t].x&&(this.freeRectangles[e].width+=this.freeRectangles[t].width,this.freeRectangles.splice(t,1),--t))},e.FreeRectChoiceHeuristic=g,e.GuillotineSplitHeuristic=d}();var u=self;u.addEventListener("message",(function(e){var t=function(e){var t=a(e);return e.forEach((function(e,i){e.x=t[i].x,e.y=t[i].y})),e}(e.data);u.postMessage(t)}),!1)}]);
//# sourceMappingURL=RectanglePacker.89b15b65e604634cf633.worker.js.map